<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <!--[if IE]>
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <![endif]-->
    <title>Free Responsive Admin Theme - ZONTAL</title>
    <!-- CSS  -->
    <link href="../assets/css/bootstrap.css" rel="stylesheet" />
    <link href="../assets/css/anxis.css" rel="stylesheet" />
    <link href="../assets/css/font-awesome.css" rel="stylesheet" />
    <link href="../assets/css/style.css" rel="stylesheet" />
    <link href="../assets/css/morris.css" rel="stylesheet" />
    <link href="../assets/css/bootstrap-dialog.css" rel="stylesheet" />
     <!-- HTML5 Shiv and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body>
    <header>
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <strong>Email de soporte: </strong>alvarop.garcia@alu.uhu.es
                </div>

            </div>
        </div>
    </header>
    <!-- HEADER END-->
    <div class="navbar navbar-inverse set-radius-zero">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="index.html">

                    <img src="assets/img/logo.png" />
                </a>

            </div>

            <div class="left-div">
                <div class="user-settings-wrapper">
                    <ul class="nav">

                        <li class="dropdown">
                            <a class="dropdown-toggle" data-toggle="dropdown" href="#" aria-expanded="false">
                                <span class="glyphicon glyphicon-user" style="font-size: 25px;"></span>
                            </a>
                            <div class="dropdown-menu dropdown-settings">
                                <div class="media">
                                    <a class="media-left" href="#">
                                        <img src="assets/img/64-64.jpg" alt="" class="img-rounded" />
                                    </a>
                                    <div class="media-body">
                                        <h4 class="media-heading">Jhon Deo Alex </h4>
                                        <h5>Developer & Designer</h5>

                                    </div>
                                </div>
                                <hr />
                                <h5><strong>Personal Bio : </strong></h5>
                                Anim pariatur cliche reprehen derit.
                                <hr />
                                <a href="#" class="btn btn-info btn-sm">Full Profile</a>&nbsp; <a href="login.html" class="btn btn-danger btn-sm">Logout</a>

                            </div>
                        </li>


                    </ul>
                </div>
            </div>
        </div>
    </div>
    <!-- LOGO HEADER END-->
    <section class="menu-section">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <div class="navbar-collapse collapse ">
                        <ul id="menu-top" class="nav navbar-nav navbar-right">
                                                        <li><a href="index_medico.html">Inicio</a></li>
                            <li><a href="pacientes_medico.html">Pacientes</a></li>
                            <li><a class="menu-top-active" href="tests_medico.html">Tests</a></li>
                            <li><a href="mensajes_medico.html">Mensajes</a></li>

                        </ul>
                    </div>
                </div>

            </div>
        </div>
    </section>
    <!-- MENU SECTION END-->
    <div class="content-wrapper">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <h4 class="page-head-line">Tests</h4>

                </div>

            </div>
            
            <div class="row">
                <div class="col-md-9 col-md-offset-1">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            Mis Tests
                        </div>
                    <div class="list-group" id="lista_tests">
    
  </div></div>
                </div>
                <div class="col-md-9 col-md-offset-1">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            Añadir Test
                        </div>
                        <div class="panel-body">
                            <div class="row">
                            <div class="col-md-6">
                                <label for="exampleInputPassword1">Título:</label>
                    <input class="form-control" id="nombre_test" type="text" placeholder="Nombre del test"></div>
                                
                            <div class="col-md-12">
                            <label for="exampleInputPassword1">Descripción:</label>
                                    <textarea id="descripcion_test" class="form-control" placeholder="Inserte su descripción" rows="3"></textarea>
                                <br>
                                <button id="crear_test" class="btn btn-info">Crear test</button><br><br>
                                </div>
                                
                                </div>

                        </div>

                        
                        
                        </div>
                </div>

            </div>

        </div>
    </div>
    <!-- CONTENT-WRAPPER SECTION END-->
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    &copy; 2016 Universidad de Huelva
                </div>

            </div>
        </div>
    </footer>
    <!-- SCRIPTS  -->
    <script src="../assets/js/jquery-1.11.1.js"></script>
    <script src="../assets/js/bootstrap.js"></script>
    <script src="../assets/js/raphael.js"></script>
    <script src="../assets/js/morris.min.js"></script>
    <script src="../assets/js/bootstrap-dialog.js"></script>

    
    <script>
var scopes = 'https://www.googleapis.com/auth/userinfo.email';
var client_id = '1019548776931-blbnd36ce3sd81n11di7nqavmsm1skrs.apps.googleusercontent.com';
var mensajes;
var movimientos;
var donut_encuestas;
var barras_tests;
    
        function handleAuth() {
    	  var request = gapi.client.oauth2.userinfo.get().execute(function(resp) {
    	    if (resp.code) {
    	    	window.location.replace("../error.html");
    	    }
    	    else {
    	    	
    	    	gapi.client.anxisendpoint.getListaTestsCreadosMedico().execute(function(resp) {

          	    	if (!resp.code) {
            			resp.items = resp.items || [];
            			var result = "";
            			for (var i=0;i<resp.items.length;i++) {

            				result += '<li href="#" class="list-group-item">';
                			result += '<div class="row">';
                			result += '<div class="col-md-9">';
                			result += '<h4 class="list-group-item-heading">'+resp.items[i].titulo+'</h4>';
                			result += '<p>'+resp.items[i].descripcion+'</p>';
                			result += '</div>';
                			result += '<div class="col-md-3">';
                			result += '<center><button id="'+resp.items[i].id_test+'" onclick="editarTest(\'' + resp.items[i].id_test + '\');" class="btn btn-info editar_test">Editar Test</button></center>';
                			result += '</div>';
                			result += '</div>';
                			result += '</li>';
            			}
            			$("#lista_tests").append(result);
            		}
          	    	  
              		console.log(resp);
              	});
      	      
    	    }
    	  });
    	}
        
        function signin(mode, callback) {
        	  gapi.auth.authorize({client_id: client_id,scope: scopes, immediate: mode},callback);
        }
    
        function init() {
        	var apisToLoad;
        	var callback = function() {
        	   if (--apisToLoad == 0) {
        	     signin(true, handleAuth);
        	   }
        	}
        	  
        	apisToLoad = 2;
        	//Parameters are APIName,APIVersion,CallBack function,API Root 
        	gapi.client.load('anxisendpoint', 'v1', callback, 'http://localhost:8888/_ah/api');
        	//gapi.client.load('anxisendpoint', 'v1', callback, 'https://mybackendapi.appspot.com/_ah/api');
        	gapi.client.load('oauth2','v2',callback);
        }
        
		function editarTest(id_test) {
			
			var listvalues = { "id_test": id_test}
			*// OR IF INTPUT IS INSIDE FORM BETTER USER JQUERY SERIALIZER var listvalues = $("#form").serialize();*
			localStorage.setItem('datos_test', JSON.stringify(listvalues)); 
			
			window.location.replace("./editar_test_medico.html");
		        	
        }
        
		$(document).ready(function(){
        	$('#crear_test').on('click', function() {
        		
        		var titulo_test = $('#nombre_test').val();
        		var descripcion_test = $('#descripcion_test').val();
        		
        		var requestData = {};
            	requestData.titulo = titulo_test;
            	requestData.descripcion = descripcion_test;
            	
            	gapi.client.anxisendpoint.crearTestMedico(requestData).execute(function(resp) {

          	    	if (!resp.code) {
          	    		
          	    		setTimeout(function() {
          	    			BootstrapDialog.show({
              	    			title: 'Mensaje enviado',
              	    			message: 'Tu test se ha creado correctamente!'
              	          });
          	    		}, 3000);
            		}
              	})
        		
        	});
        });
        
</script>
<script src="https://apis.google.com/js/client.js?onload=init"></script>
</body>
</html>
